require 'yaml'
base_dir = File.expand_path(File.dirname(__FILE__))
cluster = YAML.load_file(File.join(base_dir, "cluster.yml"))

def node config, cluster, i
  config.vm.define "node#{i}" do |node|
    node.vm.box = cluster["box"]
    node.vm.network "private_network", ip: "192.168.56.10#{i+1}"
  end
end

Vagrant.configure("2") do |config|
  config.vm.define "master" do |master|
    master.vm.box = cluster["box"]
    master.vm.network "private_network", ip: "192.168.56.101"
  end

  for i in 1..cluster["nodes"] do
    node config, cluster, i
  end
end
